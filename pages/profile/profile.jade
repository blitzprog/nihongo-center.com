include ../../mixins/forms.jade

if !user
	p Not logged in!
else
	- var ‰Ωï = undefined;
	
	+datalist("cities", cities)
	+datalist("countries", countries)
	+datalist("nationalities", nationalities)
	
	.page-header
		h2= __("personal")
	
	.profile
		+text("givenName")
		+text("familyName")
		
	if user.accessLevel === "student"
		.profile
			+select("gender", user.gender, genderOptions)
			+select("maritalStatus", user.maritalStatus, maritalStatusOptions)
			
		.profile
			+date("birthDay", user.birthDay)
			+text("birthPlace", user.birthPlace, "", "cities")
			+text("age", age, "", "", true)
		
		.page-header
			h2= __("country")
		
		.profile
			+text("country", user.country, "", "countries")
			+text("nationality", user.nationality, "", "nationalities")
		
		.page-header
			h2= __("work")
		
		.profile
			+text("occupation", user.occupation)
			+select("occupationType", user.occupationType, occupationTypeOptions)
			
		.page-header
			h2= __("contact")
		
		.profile
			+text("address", user.address, "üè†")
			+text("addressAbroad", user.addressAbroad, "üè† Only if you have one.")
			
		.profile
			+tel("telephone", user.telephone, "‚òé")
			+tel("telephoneAbroad", user.telephoneAbroad, "‚òé Only if you have one.")
		
		.page-header
			h2= __("course")
		
		.profile
			+select("course", user.course, courseOptions)
			
		.profile
			+select("startYear", user.startYear, startYearOptions)
			+select("startMonth", user.startMonth, startMonthOptions)
			
		.page-header
			h2= __("education")
		
		.profile
			+select("education", user.education, educationOptions)
			+text("educationalInstitutionName", user.educationalInstitutionName, "School or university name")
			
			+month("graduationDate", user.graduationDate)
			+number("totalPeriodOfEducation", ‰Ωï, "How many years?")
			
			+select("planAfterGraduation", user.planAfterGraduation, planAfterGraduationOptions)
			
		.page-header
			h2= __("passport")
		
		.profile
			+text("passportId", user.passportId, "e.g. TK1234567")
			+date("passportDateOfExpiration", user.passportDateOfExpiration)
			
		.profile
			+number("numberOfPastEntries", ‰Ωï, "How often did you go to Japan?")
			
		.profile
			+date("lastEntryFrom")
			+date("lastEntryTo")
		
		.page-header
			h2= __("family")
		
		#family-members.profile
			each member, index in user.familyMembers
				.profile.array-element.family-member
					+textInArray("familyMembers", index, "name", member.name)
					+textInArray("familyMembers", index, "relation", member.relation)
					+textInArray("familyMembers", index, "age", member.age)
					+textInArray("familyMembers", index, "occupation", member.occupation)
					+textInArray("familyMembers", index, "nationality", member.nationality, "", "nationalities")
					+textInArray("familyMembers", index, "country", member.country, "", "countries")
					
					a(href="javascript:remove('profile', 'FamilyMember', " + index + ");").btn.btn-danger.delete-button
						.glyphicon.glyphicon-remove
		
		button(onclick="add('profile', 'FamilyMember');").btn.btn-success
			.glyphicon.glyphicon-plus
				span(style="margin-left: 0.5em") Add family member
		
		.page-header
			h2= __("finances")
		
		p
			| Please enter the average amount of support 
			strong per month 
			| in Yen (¬•).
			
		.profile
			+numberInObject("financialSupportPerMonth", "self", "Monthly amount in Yen (¬•)")
			+numberInObject("financialSupportPerMonth", "remittanceFromOutside", "Monthly amount in Yen (¬•)")
			+numberInObject("financialSupportPerMonth", "carryingFromAbroad", "Monthly amount in Yen (¬•)")
			+numberInObject("financialSupportPerMonth", "guarantorAbroad", "Monthly amount in Yen (¬•)")
			+numberInObject("financialSupportPerMonth", "scholarship", "Monthly amount in Yen (¬•)")
			+numberInObject("financialSupportPerMonth", "others", "Monthly amount in Yen (¬•)")
			
			+select("paymentMethod", user.paymentMethod, paymentMethods)
		
		.page-header
			h2= __("financialSupporters.title")
		
		#financial-supporters.profile
			each supporter, index in user.financialSupporters
				.profile.array-element.financial-supporter
					+textInArray("financialSupporters", index, "name")
					+textInArray("financialSupporters", index, "address")
					+textInArray("financialSupporters", index, "telephone")
					+textInArray("financialSupporters", index, "occupation")
					+textInArray("financialSupporters", index, "company", ‰Ωï, "Full company name")
					+textInArray("financialSupporters", index, "companyTelephone")
					+numberInArray("financialSupporters", index, "annualIncome", ‰Ωï, "In Yen (¬•)")
					+textInArray("financialSupporters", index, "relation")
					
					a(href="javascript:remove('profile', 'FinancialSupporter', " + index + ");").btn.btn-danger.delete-button
						.glyphicon.glyphicon-remove
		
		button(onclick="add('profile', 'FinancialSupporter');").btn.btn-success
			.glyphicon.glyphicon-plus
				span(style="margin-left: 0.5em") Add financial supporter
		
		.page-header
			h2= __("japanese")
		
		.profile
			+select("jlptLevel", user.jlptLevel, jlptLevels)
			
		.profile
			+textArea("reasonForStudying", user.reasonForStudying, "What have you been doing for studying in Japan?\nWhy do you need to study Japanese?\nWhat are you going to do after you finish the Japanese course?", 12, 80)
		
		.page-header
			h2= __("japaneseStudyExperience")
		
		#education-backgrounds.profile
			each education, index in user.japaneseEducation
				.profile.array-element.education-background
					+textInArray("japaneseEducation", index, "institution")
					+numberInArray("japaneseEducation", index, "totalHours")
					+textInArray("japaneseEducation", index, "textBook")
					
					a(href="javascript:remove('profile', 'EducationBackground', " + index + ");").btn.btn-danger.delete-button
						.glyphicon.glyphicon-remove
		
		button(onclick="add('profile', 'EducationBackground');").btn.btn-success
			.glyphicon.glyphicon-plus
				span(style="margin-left: 0.5em") Add education background
		
		.page-header
			h2= __("visa")
		
		.profile
			+select("portOfEntry", user.portOfEntry, portsOfEntry)
			+text("visaApplicationPlace", ‰Ωï, "üè¢ Location of closest Japanese Embassy or Consulate")
	
	script
		include ../../scripts/arrays.js
		include save.js